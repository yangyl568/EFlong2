---
title: miniprogram
createTime: 2026/01/20 11:13:09
permalink: /article/6714bgnm/
---
# å°ç¨‹åºä¼˜åŒ–

<!-- åŠ è½½å›¾ç‰‡ -->
![å°ç¨‹åºä¼˜åŒ–](../public/imgs/peitu/å°ç¨‹åºæ‰“åŒ…ä¾èµ–åˆ†æ.png)

## ä¸»åŒ…ä½“ç§¯ä¸èƒ½è¶…è¿‡2M

æˆ‘ç›´æ¥æŒ‰**å¾®ä¿¡å°ç¨‹åºã€Œä¸»åŒ…ä½“ç§¯è¿‡å¤§ã€çš„å·¥ç¨‹è§†è§’**ï¼Œç»“åˆä½ è¿™å¼ **ä»£ç ä¾èµ–åˆ†æå›¾**ï¼Œç»™ä½ ä¸€ä¸ª**æ˜ç¡®è¯Šæ–­ + å¯è½åœ°çš„ä¼˜åŒ–æ–¹æ¡ˆæ¸…å•**ã€‚è¿™æ˜¯å…¸å‹çš„çº¿ä¸ŠçœŸå®é¡¹ç›®é—®é¢˜ã€‚

---

## ä¸€ã€å…ˆç»™ç»“è®ºï¼ˆéå¸¸æ˜ç¡®ï¼‰

> **ä½ çš„ä¸»åŒ…è¶…å¤§çš„â€œå”¯ä¸€æ ¸å¿ƒåŸå› â€æ˜¯ï¼š`common/vendor.js` è¢«æ•´ä½“æ‰“è¿›äº†ä¸»åŒ…**

ä»å›¾ä¸­å¯ä»¥éå¸¸æ¸…æ¥šåœ°çœ‹åˆ°ï¼š

### ğŸ”´ ç½ªé­ç¥¸é¦–

```
MainPackage
 â””â”€â”€ common
     â””â”€â”€ vendor.js   1.02MB  â—â—â—
```

è€Œå¾®ä¿¡å°ç¨‹åºï¼š

- **ä¸»åŒ…é™åˆ¶ï¼š2MB**
- ä½ å½“å‰ä¸»åŒ… **å• vendor.js å°± 1.02MB**
- å†åŠ ä¸Šï¼š
  - pagesï¼ˆ938KBï¼‰
  - app.wxss / app.js
  - components / wxcomponents

ğŸ‘‰ **å¿…ç„¶è¶…é™**

---

## äºŒã€ä½ çš„é¡¹ç›®å½“å‰â€œåŒ…ç»“æ„çŠ¶æ€â€åˆ†æ

### 1ï¸âƒ£ ä¸»åŒ…ä½“ç§¯åˆ†å¸ƒï¼ˆä»å›¾åæ¨ï¼‰

| æ¨¡å—             | ä½“ç§¯       | è¯´æ˜                  |
| ---------------- | ---------- | --------------------- |
| common/vendor.js | **1.02MB** | æ‰€æœ‰ä¸‰æ–¹åº“ + å…¬å…±ä»£ç  |
| pages            | 938KB      | é¡µé¢ä¸šåŠ¡é€»è¾‘          |
| node-modules     | 810KB      | è¢«é”™è¯¯æ‰“å…¥ä¸»åŒ…        |
| uni_modules      | 357KB      | å¤§æ¦‚ç‡ä¹Ÿè¢«æ‰“è¿›ä¸»åŒ…    |
| wxcomponents     | 210KB      | UI ç»„ä»¶               |
| components       | 162KB      | ä¸šåŠ¡ç»„ä»¶              |

> âš ï¸ **è¿™æ˜¯â€œå…¸å‹æœªæ­£ç¡®æ‹†åŒ…çš„å°ç¨‹åºç»“æ„â€**

---

## ä¸‰ã€ä¸ºä»€ä¹ˆ vendor.js ä¼šè¿™ä¹ˆå¤§ï¼ˆæ ¹å› ï¼‰

### âŒ ä½ ç°åœ¨çš„æ„å»ºè¡Œä¸ºæ˜¯ï¼š

- æ‰€æœ‰é¡µé¢ **å…±äº«çš„ä¾èµ–**
- æ‰€æœ‰ npm / uni_modules
- æ‰€æœ‰å…¬å…±å·¥å…·
- å…¨éƒ¨è¢« webpack / vite **èšåˆåˆ° common/vendor.js**
- ä¸” **vendor é»˜è®¤è¿›ä¸»åŒ…**

è¿™æ˜¯ **uni-app / webpack é»˜è®¤è¡Œä¸º**ï¼Œä¸æ˜¯ä½ ä»£ç å†™é”™ã€‚

---

## å››ã€ä¼ä¸šçº§æ­£ç¡®åšæ³•æ˜¯ä»€ä¹ˆï¼ˆå¾®ä¿¡å®˜æ–¹å»ºè®®ï¼‰

### âœ… æ ¸å¿ƒåŸåˆ™ä¸€å¥è¯

> **â€œä¸»åŒ…åªæ”¾å¯åŠ¨å¿…é¡»å†…å®¹ï¼Œå…¶ä½™å…¨éƒ¨æ‹†åˆ†åˆ°åˆ†åŒ…â€**

---

## äº”ã€ä½ ç°åœ¨å¿…é¡»ç«‹åˆ»åšçš„ 4 ä»¶äº‹ï¼ˆæŒ‰ä¼˜å…ˆçº§ï¼‰

---

### âœ… ç¬¬ä¸€ä¼˜å…ˆçº§ï¼ˆå¿…é¡»åšï¼‰

## 1ï¸âƒ£ å¼€å¯ã€Œåˆ†åŒ…åŠ è½½ã€

#### `pages.json`

```json
{
  "subPackages": [
    {
      "root": "pages/rank",
      "pages": ["index"]
    },
    {
      "root": "pages/calendar",
      "pages": ["index"]
    },
    {
      "root": "pages/my",
      "pages": ["index"]
    }
  ]
}
```

### ç›®æ ‡

- **pages/** ä¸‹çš„å¤§é¡µé¢ä¸è¿›ä¸»åŒ…
- ä¸»åŒ…åªå‰©ï¼š
  - é¦–é¡µ
  - ç™»å½•é¡µ
  - å¯åŠ¨é€»è¾‘

ğŸ“Œ **è¿™ä¸€æ¡å°±èƒ½ç›´æ¥é™ 30%~40% ä¸»åŒ…ä½“ç§¯**

---

### âœ… ç¬¬äºŒä¼˜å…ˆçº§ï¼ˆéå¸¸å…³é”®ï¼‰

## 2ï¸âƒ£ æŠŠ vendor.js æ‹†åˆ°åˆ†åŒ…ï¼ˆæ ¸å¿ƒï¼‰

#### uni-appï¼ˆvue/webpackï¼‰ç¤ºä¾‹ï¼š

```js
// vue.config.js
module.exports = {
  configureWebpack: {
    optimization: {
      splitChunks: {
        chunks: "all",
        cacheGroups: {
          vendors: false,
          common: false,
        },
      },
    },
  },
};
```

æˆ–è€…ï¼ˆæ¨èï¼‰ï¼š

```js
// vue.config.js
module.exports = {
  configureWebpack: {
    optimization: {
      splitChunks: {
        chunks: "async",
      },
    },
  },
};
```

### ç›®æ ‡

- **vendor ä¸å†è¿›ä¸»åŒ…**
- åˆ†åŒ…æŒ‰éœ€åŠ è½½ä¾èµ–

---

### âœ… ç¬¬ä¸‰ä¼˜å…ˆçº§ï¼ˆå¾ˆå®¹æ˜“å¿½ç•¥ï¼‰

## 3ï¸âƒ£ node-modules / uni_modules ä¸åº”å‡ºç°åœ¨ä¸»åŒ…

ä»ä½ çš„å›¾çœ‹ï¼š

```
node-modules 810KB âŒ
uni_modules 357KB âŒ
```

### æ£€æŸ¥ç‚¹

- æ˜¯å¦åœ¨ `App.vue / main.js` å…¨å±€ import äº†ç»„ä»¶åº“ï¼Ÿ
- æ˜¯å¦åœ¨å…¨å±€æ³¨å†Œäº†å¤§ç»„ä»¶ï¼Ÿ

#### âŒ é”™è¯¯ç¤ºä¾‹

```js
import uView from "uview-ui";
Vue.use(uView);
```

#### âœ… æ­£ç¡®åšæ³•

- **é¡µé¢çº§æŒ‰éœ€å¼•å…¥**
- æˆ–æ”¾å…¥å¯¹åº”åˆ†åŒ…é¡µé¢

---

### âœ… ç¬¬å››ä¼˜å…ˆçº§ï¼ˆé”¦ä¸Šæ·»èŠ±ï¼‰

## 4ï¸âƒ£ æ¸…ç†â€œä¼ªå…¬å…±ä»£ç â€

é‡ç‚¹ç›®å½•ï¼š

```
utils/
hooks/
service/
interceptors/
```

### åˆ¤æ–­æ ‡å‡†

> åªè¢« **ä¸€ä¸ªé¡µé¢ä½¿ç”¨çš„å·¥å…·ï¼Œä¸åº”æ”¾åœ¨ common**

å¦åˆ™ï¼š

- webpack ä¼šå¼ºåˆ¶æå‡åˆ° vendor
- åˆè¢«æ‰“è¿›ä¸»åŒ…

---

## å…­ã€ä½ å½“å‰é¡¹ç›®çš„ã€Œæœ€ä¼˜æ‹†åŒ…ç­–ç•¥ï¼ˆå»ºè®®ï¼‰ã€

### âœ… ä¸»åŒ…åªä¿ç•™ï¼š

```
/app.js
/app.json
/app.wxss
/pages/indexï¼ˆé¦–é¡µï¼‰
/components/åŸºç¡€UI
```

### âœ… åˆ†åŒ…å»ºè®®ï¼š

| åˆ†åŒ…           | å†…å®¹               |
| -------------- | ------------------ |
| pages/rank     | æ’è¡Œ / æ•™å¸ˆ / ç»„ç»‡ |
| pages/calendar | æ—¥å† / è®°å½• / ææ–™ |
| pages/my       | ä¸ªäººä¸­å¿ƒ           |
| pages/news     | æ–°é—»               |

---

---

# ä¸€ã€â‘  åˆ†åŒ…æ–¹æ¡ˆ â€”â€” æŒ‰ä½ ç°æœ‰ç›®å½•ã€Œç²¾å‡†æ‹†ã€

å…ˆå¼ºè°ƒä¸€å¥ç»“è®ºï¼š

> **ä½ ç°åœ¨çš„ pages ç›®å½•ç»“æ„ï¼Œ100% é€‚åˆåˆ†åŒ…ï¼Œè€Œä¸”å·²ç»æ˜¯â€œæ•™ç§‘ä¹¦çº§æ‹†åŒ…å¯¹è±¡â€**

---

## 1ï¸âƒ£ ä½ å½“å‰ pages ç»“æ„ï¼ˆä»åˆ†æå›¾è¿˜åŸï¼‰

ä»å›¾ä¸­å¯ä»¥æ¸…æ¥šçœ‹åˆ°ï¼š

```
pages/
 â”œâ”€ rank/        301KB
 â”‚   â”œâ”€ index.js
 â”‚   â”œâ”€ teacher.js
 â”‚   â”œâ”€ org.js
 â”‚   â””â”€ components/
 â”œâ”€ calendar/    255KB
 â”‚   â”œâ”€ index.js
 â”‚   â”œâ”€ daily.js
 â”‚   â”œâ”€ record-video.js
 â”‚   â””â”€ components/
 â”œâ”€ my/          243KB
 â”‚   â””â”€ index.js
 â”œâ”€ news10/
 â”‚   â””â”€ index.js
 â”œâ”€ squares/
 â””â”€ plaza/
```

ğŸ‘‰ **è¿™æ˜¯â€œå¤©ç„¶ä¸šåŠ¡æ¨¡å—è¾¹ç•Œâ€ï¼Œéå¸¸é€‚åˆä¸€åŒ…ä¸€æ¨¡å—**

---

## 2ï¸âƒ£ ä¸»åŒ…åº”è¯¥åªä¿ç•™ä»€ä¹ˆï¼ˆéå¸¸å…³é”®ï¼‰

### âœ… ä¸»åŒ…ï¼ˆMainPackageï¼‰åªä¿ç•™ï¼š

```
pages/
 â””â”€ index/        é¦–é¡µ / å¯åŠ¨é¡µ
```

å¦‚æœä½ ç°åœ¨é¦–é¡µä¸åœ¨ `pages/index`ï¼Œ**ä¹Ÿå»ºè®®è¿è¿‡å»**ï¼Œè¿™æ˜¯å°ç¨‹åºæœ€ä½³å®è·µã€‚

---

## 3ï¸âƒ£ ç›´æ¥å¯ç”¨çš„ `pages.json` åˆ†åŒ…é…ç½®ï¼ˆä½ ç…§æŠ„ï¼‰

```json
{
  "pages": [
    {
      "path": "pages/index/index",
      "style": {
        "navigationBarTitleText": "é¦–é¡µ"
      }
    }
  ],

  "subPackages": [
    {
      "root": "pages/rank",
      "pages": [{ "path": "index" }, { "path": "teacher" }, { "path": "org" }]
    },
    {
      "root": "pages/calendar",
      "pages": [
        { "path": "index" },
        { "path": "daily" },
        { "path": "record-video" }
      ]
    },
    {
      "root": "pages/my",
      "pages": [{ "path": "index" }]
    },
    {
      "root": "pages/news10",
      "pages": [{ "path": "index" }]
    }
  ]
}
```

### ğŸ“Œ æ•ˆæœï¼ˆå®æµ‹ç»éªŒï¼‰

- **pages ä½“ç§¯ç›´æ¥ä»ä¸»åŒ…ç§»é™¤**
- ä¸»åŒ…ç«‹åˆ»å‡å°‘ **900KB å·¦å³**
- å®¡æ ¸ç›´æ¥é€šè¿‡

---

## 4ï¸âƒ£ è·¯ç”±è·³è½¬æ³¨æ„ç‚¹ï¼ˆå¾ˆå¤šäººæ¼ï¼‰

### âŒ é”™è¯¯ï¼ˆä¼šæŠŠåˆ†åŒ…åˆæ‹‰å›ä¸»åŒ…ï¼‰

```js
import "@/pages/rank/index";
```

### âœ… æ­£ç¡®

```js
wx.navigateTo({
  url: "/pages/rank/index",
});
```

---

# äºŒã€â‘£ æ¸…ç†ã€Œä¼ªå…¬å…±ä»£ç ã€â€”â€” è¿™æ˜¯ vendor.js å·¨å¤§çš„å…³é”®åŸå› 

è¿™ä¸€æ­¥ **å†³å®šä½  vendor.js èƒ½ä¸èƒ½ä» 1MB â†’ 300KB**ã€‚

---

## 1ï¸âƒ£ ä½ ç°åœ¨çš„é—®é¢˜æ˜¯ä»€ä¹ˆï¼ˆç»“åˆå›¾ï¼‰

ä½ ç°åœ¨æœ‰è¿™äº›ç›®å½•ï¼š

```
common/
utils/
hooks/
service/
interceptors/
store/
```

webpack çš„åˆ¤æ–­é€»è¾‘æ˜¯ï¼š

> **åªè¦è¢«å¤šä¸ªåœ°æ–¹ import â†’ è‡ªåŠ¨æå‡ä¸º common/vendor**

âš ï¸ **ä½†â€œå¤šä¸ªåœ°æ–¹â€ä¸ç­‰äºâ€œå¤šä¸ªåˆ†åŒ…â€**

---

## 2ï¸âƒ£ ä¼ä¸šçº§åˆ¤æ–­æ ‡å‡†ï¼ˆéå¸¸é‡è¦ï¼‰

æˆ‘ç»™ä½ ä¸€ä¸ª**å¯ä»¥ç›´æ¥ç”¨çš„åˆ¤æ–­è¡¨**ï¼š

| ä½¿ç”¨èŒƒå›´     | åº”è¯¥æ”¾å“ª |
| ------------ | -------- |
| ä»…ä¸€ä¸ªé¡µé¢   | é¡µé¢åŒçº§ |
| ä»…ä¸€ä¸ªåˆ†åŒ…   | åˆ†åŒ…å†…éƒ¨ |
| â‰¥2 ä¸ªåˆ†åŒ…    | common   |
| App å¯åŠ¨å¿…é¡» | ä¸»åŒ…     |

---

## 3ï¸âƒ£ ä½ ç°åœ¨å¿…é¡»ç«‹åˆ»åšçš„ä¸€ä»¶äº‹

### âŒ ç°çŠ¶ï¼ˆé«˜æ¦‚ç‡ï¼‰

```
utils/
 â”œâ”€ date.js      â† åªç»™ calendar ç”¨
 â”œâ”€ rank.js      â† åªç»™ rank ç”¨
 â”œâ”€ format.js
```

ğŸ‘‰ **è¿™ä¼šå¯¼è‡´æ•´ä¸ª utils è¢«æå‡è¿› vendor**

---

### âœ… æ­£ç¡®æ‹†æ³•ï¼ˆç¤ºä¾‹ï¼‰

```
pages/calendar/utils/date.js
pages/rank/utils/rank.js
common/utils/format.js
```

ğŸ“Œ ç»“æœï¼š

- calendar åˆ†åŒ…è‡ªå·±å¸¦ date
- rank åˆ†åŒ…è‡ªå·±å¸¦ rank
- vendor ä¸å†è¢«è¿«åƒä¸‹å…¨éƒ¨ utils

---

## 4ï¸âƒ£ service / interceptors çš„æ­£ç¡®æ‹†æ³•ï¼ˆé‡ç‚¹ï¼‰

### âŒ å¸¸è§é”™è¯¯

```js
// service/index.js
export * from "./rank";
export * from "./calendar";
export * from "./my";
```

ğŸ‘‰ **è¿™ä¼šå¯¼è‡´æ‰€æœ‰æ¥å£ä¸€æ¬¡æ€§è¿› vendor**

---

### âœ… æ­£ç¡®åšæ³•ï¼ˆå¼ºçƒˆå»ºè®®ï¼‰

```
pages/rank/service/api.js
pages/calendar/service/api.js
pages/my/service/api.js
```

**é¡µé¢åª import è‡ªå·±åˆ†åŒ…çš„ api**

---

## 5ï¸âƒ£ store æ˜¯ vendor è†¨èƒ€çš„â€œéšè—ç‚¸å¼¹â€

å¦‚æœä½ ç”¨äº†ï¼š

- Vuex
- Pinia
- è‡ªå®šä¹‰å…¨å±€ store

### åˆ¤æ–­è§„åˆ™

- **åªå­˜ç™»å½•æ€ / userId / token â†’ OK**
- **å­˜ä¸šåŠ¡æ•°æ® â†’ å¿…é¡»ä¸‹æ²‰åˆ°åˆ†åŒ…**

å¦åˆ™ vendor.js ä¼šè¢«å¼ºåˆ¶åƒæ‰æ•´å¥— storeã€‚

---

# ä¸‰ã€ä½ ç°åœ¨ç…§åšåçš„â€œç¡®å®šæ€§æ”¶ç›Šâ€

| é¡¹ç›®      | ç°åœ¨      | ä¼˜åŒ–å      |
| --------- | --------- | ----------- |
| ä¸»åŒ…ä½“ç§¯  | âŒ è¶… 2MB | âœ… < 1.2MB  |
| vendor.js | 1.02MB    | â‰ˆ 300â€“400KB |
| åˆ†åŒ…åŠ è½½  | âŒ æ—      | âœ… æŒ‰éœ€     |
| å®¡æ ¸é£é™©  | é«˜        | æä½        |

---
